SE = SD/sqrt(N),                   # standard error
MAX = max(nosema_load_spores.bee, na.rm=T)
)
# Plot the time series data by group (yard in this case)
# the fist line of code calls in the data set and sets the variables
ggplot(data=pltN, aes(x=sampling_event, y=mean, group=yard, color=yard)) +
ylab("Nosema Load (spores/bee)") + # y axis label
xlab("Sampling Event") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
geom_line(size=1.5) + # create lines and set thickness
geom_point(size=4, shape=18) + # create points and set size and shape
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2) + # add standard errors
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Yard:") # color pallets option = A-H
# statistical analysis
# create the model
mod1 <- lmer(data=ds, nosema_load_spores.bee ~ yard * sampling_event + (1|lab_ID))
summary(mod1) # look at the summary of the model
# subset of dataset with rows that have a LN2 test
FKB_2021 <- ds_2021[!is.na(ds$FKB_percentile),]
# select only columns we need
FKB_2021 <- select(FKB_2021, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2021) <- c("lab_ID", "percent_hygienic")
# change column names
colnames(FKB_2021) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2021 <- merge(x=ds_2021, y=FKB_2021, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# new plot that removes time points as a factor
ggplot(ds, aes(x=percent_hygienic, y=varroa_load_mites.100.bees)) +
#geom_point(size=0) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) # size of the text and label ticks
# new plot that removes time points as a factor
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees)) +
#geom_point(size=0) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) # size of the text and label ticks
# set directory:
setwd("~/Documents/GitHub/SARE")
# install libraries
library(dplyr)
library(ggplot2)
library(lme4)
library(tidyr)
library(viridis)
library(car)
library(imputeTS)
# load in data
#ds <- read.csv("SARE_Field_database2022.csv", header = TRUE, stringsAsFactors = FALSE)
ds <- read.csv("SARE_field_database2022.csv", header = TRUE, stringsAsFactors = FALSE)
virus <- read.csv("DWV_SARE2021.csv", header = TRUE, stringsAsFactors = FALSE)
# colonies that were removed
d <- ds[grepl(ds$comments, pattern = "removed from", fixed = TRUE),]
# make sure ids are unique
unique_to_remove <- unique(d$lab_ID)
# pull rows out that match these values
ds = filter(ds, !(lab_ID %in% unique_to_remove))
ds_2021<- ds[ds$year == 2021, ]
ds_2022 <- ds[ds$year == 2022, ]
#### VARROA ANALYSIS
# aggregate mite load by sampling event and yard
pltV <- ds_2021 %>% # operate on the dataframe (ds) and assign to new object (V)
group_by(sampling_event, yard) %>% # pick variables to group by
summarise(
mean = mean(varroa_load_mites.100.bees, na.rm=T), # mean
SD = sd(varroa_load_mites.100.bees, na.rm=T), # standard dev.
N = length(varroa_load_mites.100.bees), # sample size
SE = SD/sqrt(N),                   # standard error
MAX = max(varroa_load_mites.100.bees, na.rm=T)
)
# Plot the time series data by group (yard in this case)
# the fist line of code calls in the data set and sets the variables
ggplot(data=pltV, aes(x=sampling_event, y=mean, group=yard, color=yard)) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Sampling Event") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
geom_line(size=1.5) + # create lines and set thickness
geom_point(size=4, shape=18) + # create points and set size and shape
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2) + # add standard errors
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Yard:") # color pallets option = A-H
# statistical analysis
# create the model
mod1 <- lmer(data=ds_2021, varroa_load_mites.100.bees ~ yard * sampling_event + (1|lab_ID))
summary(mod1) # look at the summary of the model
Anova(mod1) # check significance
#### NOSEMA ANALYSIS
# aggregate nosema load by sampling event and yard
pltN <- ds_2021 %>% # operate on the dataframe (ds_2021) and assign to new object (pltN)
group_by(sampling_event, yard) %>% # pick variables to group by
summarise(
mean = mean(nosema_load_spores.bee, na.rm=T), # mean
SD = sd(nosema_load_spores.bee, na.rm=T), # standard dev.
N = length(nosema_load_spores.bee), # sample size
SE = SD/sqrt(N),                   # standard error
MAX = max(nosema_load_spores.bee, na.rm=T)
)
# Plot the time series data by group (yard in this case)
# the fist line of code calls in the data set and sets the variables
ggplot(data=pltN, aes(x=sampling_event, y=mean, group=yard, color=yard)) +
ylab("Nosema Load (spores/bee)") + # y axis label
xlab("Sampling Event") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
geom_line(size=1.5) + # create lines and set thickness
geom_point(size=4, shape=18) + # create points and set size and shape
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE), width=.2) + # add standard errors
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Yard:") # color pallets option = A-H
# statistical analysis
# create the model
mod1 <- lmer(data=ds, nosema_load_spores.bee ~ yard * sampling_event + (1|lab_ID))
summary(mod1) # look at the summary of the model
Anova(mod1) # check significance
# subset of dataset with rows that have a LN2 test
FKB_2021 <- ds_2021[!is.na(ds$FKB_percentile),]
# select only columns we need
FKB_2021 <- select(FKB_2021, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2021) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2021 <- merge(x=ds_2021, y=FKB_2021, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# new plot that removes time points as a factor
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees)) +
#geom_point(size=0) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) # size of the text and label ticks
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees~percent_hygienic  sampling_event )
# HB by varroa load model
mod2 <- lm(data=ds_2021, varroa_load_mites.100.bees~percent_hygienic  sampling_event )
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees~percent_hygienic  sampling_event )
# take only sampling event 2
dst2 <- ds[ds$sampling_event==2,]
# take only sampling event 2
dst2 <- ds[ds$sampling_event==2,]
# take only sampling event 2
dst2 <- ds[ds$sampling_event==2,]
# Hygienic behavior by hive/yard, points number of hives, threshold dotted bar
ggplot(dst2, aes(x=yard, y=percent_hygienic, color=yard)) +
geom_boxplot(size=1) +
geom_text(aes(label=lab_ID), size=5) +
guides(color = guide_legend(override.aes = list(label = ''))) +
ylab("Percent Hygienic Behavior") + # y axis label
xlab("Bee Yard") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "none") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H") +# color pallets option = A-H
geom_hline(yintercept=.8, linetype="dashed",
color = "red", size=1)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# new plot that removes time points as a factor
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees)) +
#geom_point(size=0) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) # size of the text and label ticks
# Hygienic behavior by hive/yard, points number of hives, threshold dotted bar
ggplot(ds_2021, aes(x=yard, y=percent_hygienic, color=yard)) +
geom_boxplot(size=1) +
geom_text(aes(label=lab_ID), size=5) +
guides(color = guide_legend(override.aes = list(label = ''))) +
ylab("Percent Hygienic Behavior") + # y axis label
xlab("Bee Yard") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "none") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H") +# color pallets option = A-H
geom_hline(yintercept=.8, linetype="dashed",
color = "red", size=1)
# set up the model
mod3 <- aov(data = dst2, percent_hygienic ~ yard)
summary(mod3)
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees~percent_hygienic  sampling_event )
# statistical analysis
# create the model
mod1 <- lmer(data=ds, nosema_load_spores.bee ~ yard * sampling_event + (1|lab_ID))
# statistical analysis
# create the model
mod1 <- lmer(data=ds, nosema_load_spores.bee ~ yard * sampling_event + (1|lab_ID))
summary(mod1) # look at the summary of the model
Anova(mod1) # check significance
# statistical analysis
# create the model
mod1 <- lmer(data=ds_2021, varroa_load_mites.100.bees ~ yard * sampling_event + (1|lab_ID))
summary(mod1) # look at the summary of the model
Anova(mod1) # check significance
# MODEL NOT WORKING
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees~percent_hygienic  sampling_event )
summary(mod2)
Anova(mod2)
# Hygienic behavior by hive/yard, points number of hives, threshold dotted bar
ggplot(ds_2021, aes(x=yard, y=percent_hygienic, color=yard)) +
geom_boxplot(size=1) +
geom_text(aes(label=lab_ID), size=5) +
guides(color = guide_legend(override.aes = list(label = ''))) +
ylab("Percent Hygienic Behavior") + # y axis label
xlab("Bee Yard") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "none") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H") +# color pallets option = A-H
geom_hline(yintercept=.8, linetype="dashed",
color = "red", size=1)
# set up the model
mod3 <- aov(data = ds_2021, percent_hygienic ~ yard)
summary(mod3)
# MODEL NOT WORKING-- unexpected symbol in mod2
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees ~ percent_hygienic  sampling_event )
summary(mod2)
# set up the model
mod3 <- aov(data = ds_2021, percent_hygienic ~ yard)
# set up the model
mod3 <- aov(data = ds_2021, percent_hygienic ~ yard)
summary(mod3)
# print table in increasing order based on some variable
dst2[order(dst2$percent_hygienic, decreasing = TRUE),]
# print table in increasing order based on some variable
ds_2021[order(ds_2021$percent_hygienic, decreasing = TRUE),]
##### HONEY YIELD ANALYSIS
# take only sampling event 4
dst4 <- ds_2021[ds_2021$sampling_event==4,]
##### HONEY YIELD ANALYSIS
# take only sampling event 4
dst4 <- ds_2021[ds_2021$sampling_event==4,]
##### HONEY YIELD ANALYSIS
# take only sampling event 4
dst4 <- ds_2021[ds_2021$sampling_event==4,]
# plot Honey yield by hive/yard
ggplot(dst4, aes(x=yard, y=honey_removed, color=yard)) +
geom_boxplot(size=1) +
geom_text(aes(label=lab_ID), size=5) +
guides(color = guide_legend(override.aes = list(label = ''))) +
ylab("Honey Yield (lbs.)") + # y axis label
xlab("Bee Yard") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "none") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H") # color pallets option = A-H
#### FRAMES OF BEES ANALYSIS
# take only sampling event 1
dst1 <- ds_2021[ds_2021$sampling_event==1,]
# plot Honey yield by hive/yard
ggplot(dst1, aes(x=yard, y=frame_of_bees, color=yard)) +
geom_boxplot(size=1) +
geom_text(aes(label=lab_ID), size=5) +
guides(color = guide_legend(override.aes = list(label = ''))) +
ylab("Frames of Bees") + # y axis label
xlab("Bee Yard") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "none") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H") # color pallets option = A-H
# aggregate mite load by sampling event and yard
modelDF <- ds_2021 %>% # operate on the dataframe (ds) and assign to new object
group_by(lab_ID, yard) %>% # pick variables to group by
summarise(
varroa = mean(varroa_load_mites.100.bees, na.rm=T),
nosema = mean(nosema_load_spores.bee, na.rm=T),
hygienic = mean(FKB_percentage, na.rm=T),
honey = mean(honey_removed, na.rm=T),
weight = mean(october_weight, na.rm=T)
)
# aggregate mite load by sampling event and yard
modelDF <- ds_2021 %>% # operate on the dataframe (ds) and assign to new object
group_by(lab_ID, yard) %>% # pick variables to group by
summarise(
varroa = mean(varroa_load_mites.100.bees, na.rm=T),
nosema = mean(nosema_load_spores.bee, na.rm=T),
hygienic = mean(FKB_percentile, na.rm=T),
honey = mean(honey_removed, na.rm=T),
weight = mean(october_weight, na.rm=T)
)
modelDF <- merge(modelDF, virus, by = c("lab_ID"))
# impute missing values:
imputedDF <- na_mean(modelDF[,3:8])
# merge ds back together with ID vars
imputedDF <- cbind(imputedDF, modelDF[,1:2])
# create function to rescale
range01 <- function(x){
(x-min(x))/(max(x)-min(x))
}
# call the function on each var
varroaScaled <- range01(imputedDF$varroa)
nosemaScaled <- range01(imputedDF$nosema)
hygienicScaled <- range01(imputedDF$hygienic)
honeyScaled <- range01(imputedDF$honey)
weightScaled <- range01(imputedDF$weight)
dwvScaled <- range01(imputedDF$NormGenomeCopy)
mn <- mean(sum(nosemaScaled), sum(weightScaled), sum(varroaScaled), sum(honeyScaled), sum(hygienicScaled), sum(dwvScaled))
varroaScaled <- (varroaScaled/sum(varroaScaled))*mn
nosemaScaled <- (nosemaScaled/sum(nosemaScaled))*mn
hygienicScaled <- (hygienicScaled/sum(hygienicScaled))*mn
honeyScaled <- (honeyScaled/sum(honeyScaled))*mn
weightScaled <- (weightScaled/sum(weightScaled))*mn
dwvScaled <- (dwvScaled/sum(dwvScaled))*mn
# create histogram data set of scaled vals
histogram <- data.frame(varroaScaled, nosemaScaled, hygienicScaled, honeyScaled, weightScaled, dwvScaled)
histogramLong <- gather(histogram, condition, measurement, varroaScaled, nosemaScaled, hygienicScaled, honeyScaled, weightScaled, dwvScaled)
# plot histogram of all scaled values
ggplot(histogramLong ,aes(x=measurement, fill=condition)) +
geom_histogram(alpha = 0.5, position = "identity") +
ylab("Frequency") + # y axis label
xlab("Parameter Value") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "right") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Parameter") # color pallets option = A-H
#c(varroa=12, nosema=5, hygienic=12, honey=10, weight=8, dwv=1)
# create fitness function
Fitness = (-3 * varroaScaled) +
(-3 * nosemaScaled) +
(3 * hygienicScaled) +
(-3 * dwvScaled) +
(3 * honeyScaled) +
(3 * weightScaled)
# rescale 0 to 1
imputedDF$Fitness <- range01(Fitness)
death <- select(ds[ds$sampling_event==6,], overwinter_success, lab_ID)
imputedDF <- merge(imputedDF, death)
tp6 <- read.csv("TP6Data.csv")
imputedDF <- merge(imputedDF, tp6)
# print the sorted data set
orderedDF <- imputedDF[order(imputedDF$Fitness, decreasing = TRUE),]
orderedDF
pcaDS <- orderedDF[!orderedDF$lab_ID==34,]
pcaDS <- select(pcaDS, overwinter_success, varroa, nosema, hygienic, honey, weight, NormGenomeCopy)
mod <- aov(pcaDS$honey~pcaDS$overwinter_success)
summary(mod)
boxplot(pcaDS$honey~pcaDS$overwinter_success)
# subset of dataset with rows that have a LN2 test
FKB_2021 <- ds_2021[!is.na(ds$FKB_percentile),]
# select only columns we need
FKB_2021 <- select(FKB_2021, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2021) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2021 <- merge(x=ds_2021, y=FKB_2021, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# new plot that removes time points as a factor
ggplot(ds_2021, aes(x=percent_hygienic, y=varroa_load_mites.100.bees)) +
#geom_point(size=0) +
geom_smooth(method=lm, se=TRUE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) # size of the text and label ticks
# MODEL NOT WORKING-- unexpected symbol in mod2
# HB by varroa load model
mod2 <- lm(data=ds, varroa_load_mites.100.bees ~ percent_hygienic  sampling_event )
summary(mod2)
Anova(mod2)
# subset of dataset with rows that have a LN2 test
FKB_2022 <- ds_2022[!is.na(ds$FKB_percentile),]
# select only columns we need
FKB_2022 <- select(FKB_2022, lab_ID, FKB_percentile)
# select only columns we need
FKB_2022 <- select(FKB_2022, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2022) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2022 <- merge(x=ds_2022, y=FKB_2022, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2022, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2022, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# subset of dataset with rows that have a LN2 test
FKB_2022 <- ds_2022[!is.na(ds$FKB_percentile),]
# select only columns we need
FKB_2022 <- select(FKB_2022, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2022) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2022 <- merge(x=ds_2022, y=FKB_2022, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2022, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2022, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
# subset of dataset with rows that have a LN2 test
FKB_2022 <- ds_2022[!is.na(ds_2022$FKB_percentile),]
# select only columns we need
FKB_2022 <- select(FKB_2022, lab_ID, FKB_percentile)
# change column names
colnames(FKB_2022) <- c("lab_ID", "percent_hygienic")
# merge hygienic behavior back in
ds_2022 <- merge(x=ds_2022, y=FKB_2022, all.x = TRUE)
## Plot HB by varroa load
# Add regression lines
ggplot(ds_2022, aes(x=percent_hygienic, y=varroa_load_mites.100.bees,
color=as.character(sampling_event))) +
#geom_point(size=0) +
geom_smooth(method=lm, se=FALSE, fullrange=TRUE) +
geom_point(size=2) +
ylab("Varroa Load (mites/100 bees)") + # y axis label
xlab("Percent Hygienic Behavior") + # x axis label
theme_minimal(base_size = 17) + # size of the text and label ticks
theme(legend.position = "top") + # place the legend at the top
scale_color_viridis(discrete = TRUE, option="H", name="Time Point:") + # color pallets option = A-H
#geom_text(aes(label=lab_ID)) +
guides(color = guide_legend(override.aes = list(label = '')))
